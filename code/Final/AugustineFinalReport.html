<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Final Report for Cap DAP</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="AugustineFinalReport_files/libs/clipboard/clipboard.min.js"></script>
<script src="AugustineFinalReport_files/libs/quarto-html/quarto.js"></script>
<script src="AugustineFinalReport_files/libs/quarto-html/popper.min.js"></script>
<script src="AugustineFinalReport_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AugustineFinalReport_files/libs/quarto-html/anchor.min.js"></script>
<link href="AugustineFinalReport_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AugustineFinalReport_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AugustineFinalReport_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AugustineFinalReport_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AugustineFinalReport_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Report for Cap DAP</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean environment</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/ebar/Library/CloudStorage/OneDrive-St.LawrenceUniversity/Classes/Biostats/Biostats F24/Student Work/R Projects/CapDAP/Augustine-Capstone-Project</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm
Loading required package: survival
Loading required package: TH.data
Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select


Attaching package: 'TH.data'

The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Attaching package: 'car'

The following object is masked from 'package:dplyr':

    recode

The following object is masked from 'package:purrr':

    some</code></pre>
</div>
</div>
<p>##Introduction</p>
<p>Data Set Description:</p>
<p>Source of Data: The data originally comes from the E141 experiment at the Cedar Creek Ecosystem Science Reserve. The purpose of this data set was to investigate how different global changes (altered CO2 and nitrogen levels) affect plant processes such as assimilation rate and transpiration rates.</p>
<p>Time Frame: The measurements taken were collected during 1998 to 2013 growing season.</p>
<p>Size of Data set: The data set contains measurements from thousands of plant samples across multiple treatment plots. After filtering the final data set had approx. 5,500 observations, each with an associated trait measurements including assimilation and transpiration rates, with corresponding CO2 and nitrogen treatments.</p>
<p>Data Preparation: Before performing analysis, data was cleaned and filtered to remove missing or nonsense values. Treatments were converted to factors, and exploratory data analyses was conducted to understand distributions, outlier checks, and to identify statisitcal tests. Specifically;</p>
<p>Converted CO2_Treatment and Nitrogen_Treatment to factor variables.</p>
<p>Filtered out non complete records.</p>
<p>Outliers removed such as 2003 when other factors other then applied treatments affected transpiration rates.</p>
<p>Made initial plots to assess visually distributions and identify violations of normality or that of equal variances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the filtered dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"filtered_e141_Photosynthesis_data.csv"</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert treatments to factors</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>CO2_Treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>CO2_Treatment)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Nitrogen_Treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Nitrogen_Treatment)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X Year Plot Ring CO2_Treatment Nitrogen_Treatment CountOfSpecies
1 1 1998    8    1       Cenrich            Nenrich              1
2 2 1998    8    1       Cenrich            Nenrich              1
3 3 1998    8    1       Cenrich            Nenrich              1
4 4 1998    8    1       Cenrich            Nenrich              1
5 5 1998    8    1       Cenrich            Nenrich              1
6 6 1998    8    1       Cenrich            Nenrich              1
         measured_species measured_group photo_rep      date     time
1 Schizachyrium scoparium             C4         1 7/17/1998  9:32 AM
2 Schizachyrium scoparium             C4         1 7/17/1998  9:35 AM
3 Schizachyrium scoparium             C4         2 7/21/1998 10:56 AM
4 Schizachyrium scoparium             C4         2 7/21/1998 11:00 AM
5 Schizachyrium scoparium             C4         3 7/23/1998  9:43 AM
6 Schizachyrium scoparium             C4         3 7/23/1998  9:46 AM
  measurement_taken_at_growth_CO2  PAR transpiration_rate
1                         atgrwth 2173              1.969
2                           other 2181              1.969
3                         atgrwth 1271              2.150
4                           other 1341              2.581
5                         atgrwth 1854              2.165
6                           other 1565              1.781
  Amax_area_mol_CO2_m2_s1 tleaf gs_mmol_m2_s1 A_gs_mmol_CO2_mol_H2O SLA_cm2_g
1                    16.8  29.0          68.7               0.24533     249.0
2                     9.4  27.1          80.4               0.11677     249.0
3                    12.6  25.9         123.3               0.10211     186.8
4                     7.3  25.7         152.5               0.04810     186.8
5                    13.6  28.6          79.3               0.17098     213.5
6                     9.2  25.1          86.2               0.10675     213.5
  assimilation_rate portable_gas_exchange_system_used
1             419.4                           Ciras-1
2             233.6                           Ciras-1
3             235.2                           Ciras-1
4             137.0                           Ciras-1
5             289.5                           Ciras-1
6             196.5                           Ciras-1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,495
Columns: 22
$ X                                 &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1…
$ Year                              &lt;int&gt; 1998, 1998, 1998, 1998, 1998, 1998, …
$ Plot                              &lt;int&gt; 8, 8, 8, 8, 8, 8, 8, 8, 13, 13, 13, …
$ Ring                              &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ CO2_Treatment                     &lt;fct&gt; Cenrich, Cenrich, Cenrich, Cenrich, …
$ Nitrogen_Treatment                &lt;fct&gt; Nenrich, Nenrich, Nenrich, Nenrich, …
$ CountOfSpecies                    &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 16, 16, 16, …
$ measured_species                  &lt;chr&gt; "Schizachyrium scoparium", "Schizach…
$ measured_group                    &lt;chr&gt; "C4", "C4", "C4", "C4", "C4", "C4", …
$ photo_rep                         &lt;int&gt; 1, 1, 2, 2, 3, 3, 4, 4, 3, 3, 3, 3, …
$ date                              &lt;chr&gt; "7/17/1998", "7/17/1998", "7/21/1998…
$ time                              &lt;chr&gt; "9:32 AM", "9:35 AM", "10:56 AM", "1…
$ measurement_taken_at_growth_CO2   &lt;chr&gt; "atgrwth", "other", "atgrwth", "othe…
$ PAR                               &lt;dbl&gt; 2173, 2181, 1271, 1341, 1854, 1565, …
$ transpiration_rate                &lt;dbl&gt; 1.969, 1.969, 2.150, 2.581, 2.165, 1…
$ Amax_area_mol_CO2_m2_s1           &lt;dbl&gt; 16.8, 9.4, 12.6, 7.3, 13.6, 9.2, 14.…
$ tleaf                             &lt;dbl&gt; 29.0, 27.1, 25.9, 25.7, 28.6, 25.1, …
$ gs_mmol_m2_s1                     &lt;dbl&gt; 68.7, 80.4, 123.3, 152.5, 79.3, 86.2…
$ A_gs_mmol_CO2_mol_H2O             &lt;dbl&gt; 0.24533, 0.11677, 0.10211, 0.04810, …
$ SLA_cm2_g                         &lt;dbl&gt; 249.0, 249.0, 186.8, 186.8, 213.5, 2…
$ assimilation_rate                 &lt;dbl&gt; 419.4, 233.6, 235.2, 137.0, 289.5, 1…
$ portable_gas_exchange_system_used &lt;chr&gt; "Ciras-1", "Ciras-1", "Ciras-1", "Ci…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(data<span class="sc">$</span>CO2_Treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Camb"    "Cenrich"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(data<span class="sc">$</span>Nitrogen_Treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Namb"    "Nenrich"</code></pre>
</div>
</div>
<p>##Analysis</p>
<p>Below I present two separate analyses that both follow the workflow used in class. Each include:</p>
<p>Biological justifications and hypotheses.</p>
<p>Plot -&gt; Guess Relationships -&gt; Create model -&gt; Check model assumptions -&gt; Interpret model -&gt; Final Plot.</p>
<p>A final statement of results and their biological reasoning.</p>
<p>Analysis 1: Effect of CO2 treatment on Assimilation Rates</p>
<p>Bio Justification and Hypotheses:</p>
<p>Null Hypothesis: There is no significant difference in assimilation rate between two CO2 treatments (eg. Cenrich (enriched) vs.&nbsp;Camb (ambient))</p>
<p>Alternative Hypothesis: There is a significant difference in assimilation rates between Cenrich and Camb CO2 treatments.</p>
<p>Biological reasoning: Elevated CO2 can stimulate photosynthesis (Ainsworth &amp; Long 2005), but under experimental conditions plants may acclimate or other limiting factors might reduce the expected increase in assimilation. Testing the differences in ambient and enriched CO2 plots may help understand how global change affects plant carbon gain.</p>
<p>Data Types:</p>
<p>Predictor Variable: CO2_Treatment (factor with levels including “Camb” and “Cenrich”)</p>
<p>Response Variable: assimilation_rate (continuous, measured rate of carbon assimilation by leaves)</p>
<p>Data Visual and Initial Guesses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> assimilation_rate, <span class="at">fill =</span> CO2_Treatment))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Assimilation Rates by CO2 Treatments"</span>, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Assimilation Rate"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AugustineFinalReport_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: Both treatments show a unimodal distribution with some higher value outliers. The box plots (not shown here but done in previous explorations) suggests no strong difference in medians between the treatments. So we guess that there may be no significant difference.</p>
<p>Model Selection:</p>
<p>Both normality and equal variance assumptions are violated (as shown by Shapiro-Wilk and Levene’s tests), so we selected a non-parametric test (Mann-Whitney U test)</p>
<p>Assumption Check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality Test</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(data<span class="sc">$</span>assimilation_rate[data<span class="sc">$</span>CO2_Treatment <span class="sc">==</span> <span class="st">"Camb"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  data$assimilation_rate[data$CO2_Treatment == "Camb"]
W = 0.88556, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(data<span class="sc">$</span>assimilation_rate[data<span class="sc">$</span>CO2_Treatment <span class="sc">==</span> <span class="st">"Cenrich"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  data$assimilation_rate[data$CO2_Treatment == "Cenrich"]
W = 0.88978, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#variance Test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(assimilation_rate <span class="sc">~</span> CO2_Treatment, <span class="at">data =</span> data) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
        Df F value    Pr(&gt;F)    
group    1   23.78 1.111e-06 ***
      5493                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Normality (Shapiro-Wilk): Both groups had p-values &lt; 0.05, normality is violated.</p>
<p>Equal Variance (Levene’s Test): p &lt; 0.05, variances are not equal.</p>
<p>Given these, we do not use a t-test, but a Wilcoxon Rank Sum test.</p>
<p>Stat Analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wilcox_results<span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(assimilation_rate <span class="sc">~</span> CO2_Treatment, <span class="at">data =</span> data) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>wilcox_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  assimilation_rate by CO2_Treatment
W = 3834290, p-value = 0.05745
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p>W = 3,834,290, p = 0.05745</p>
<p>Interpretation:</p>
<p>Since p &gt; 0.05, we fail to reject the null hypothesis. There is no statistically significant difference in assimilation rates between ambient and enriched CO2 treatments</p>
<p>Biological Interpretation:</p>
<p>Even though initial expectations say that elevated CO2 might increase assimilation (Ainsworth &amp; Long 2005), the results suggest no statistically meaningful difference under the conditions. It may be that other factors came into play (nutrients, water availability etc.) hindered the effect of CO2 enrichment on assimilation. Another possibility explained in scholarship may be a reduced initial stimulation of photosynthesis by increased CO2.</p>
<p>As per the Wilcoxon test the test does not use means or standard deviations but rather the rankings of the values so no need for those, also we found no significant difference so no need for a final plot BUT…. lets get some visuals anyway and show means and all that in a plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>summary_means <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CO2_Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_assim =</span> <span class="fu">mean</span>(assimilation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>assimilation_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> CO2_Treatment, <span class="at">y =</span> assimilation_rate)) <span class="sc">+</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> grand_mean, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> summary_means, <span class="fu">aes</span>(<span class="at">x =</span> CO2_Treatment, <span class="at">y =</span> mean_assim), </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span> <span class="st">"red"</span>, <span class="at">size=</span><span class="dv">5</span>, <span class="at">shape=</span> <span class="dv">21</span>, <span class="at">fill=</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Assimilation Rates by CO2 Treatment"</span>, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"CO2 Treatment"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Assimilation Rate"</span>, </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="st">"Points show all observations, red circles are treatment means, dashed line is grand mean"</span>) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AugustineFinalReport_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Analysis 2: Two-Way ANOVA for CO2 and Nitrogen Treatment on Transpiration Rates</p>
<p>Biological Justification and Hypotheses</p>
<p>Null CO2: There is no significant effect of CO2 treatment on transpiration rates. Null Nitrogen: There is no significant effect of nitrogen treatment on transpiration rates. Null interaction: There is no significant interaction between CO2 and nitrogen treatments on transpiration rates.</p>
<p>Alternative Hypotheses:</p>
<p>Alt CO2: CO2 treatments significantly affects transpiration rates. Alt Nitrogen: Nitrogen treatment significantly affects transpiration rates. Alt Interaction: There is a significant interaction between CO2 and nitrogen treatments on transpiration rates.</p>
<p>Biological Reasoning: Transpiration rates can be influenced by physiology, stomatal conductance, and Nitrogen presence. Increased CO2 can reduce stomatal conductance, which can lower transpiration (Leakey et al.&nbsp;2009). Nitrogen presence levels can influence leaf area and metabolism, which can potentially affect transpiration as well. The interaction test if for whether effects of CO2 change dependent on N levels.</p>
<p>Data Types:</p>
<p>Predictor Variables: CO2_Treatment (factor, Camb or Cenrich) Nitrogen_Treatment (factor, Namb or Nenrich)</p>
<p>Response variable: transpiration_rate (continuous)</p>
<p>Data Visual and Guess</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span> Nitrogen_Treatment, <span class="at">y=</span> transpiration_rate, <span class="at">fill =</span> CO2_Treatment)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Transpiration Rates by Nitrogen and CO2 Treatment"</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Nitrogen Treatment"</span>, <span class="at">y=</span> <span class="st">"Transpiration Rate"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AugustineFinalReport_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation Of Plot: The median transpiration rate appears similar across the nitrogen treatments, but CO2 enriched shows in a general sense lower transpiration rates. The variability looks consistence across it all with some higher value outliers. Suspect a main effect of CO2 but not with nitrogen.</p>
<p>Model time and Checking Assumptions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span> <span class="fu">aov</span>(transpiration_rate <span class="sc">~</span> Nitrogen_Treatment <span class="sc">*</span> CO2_Treatment, <span class="at">data =</span> data)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AugustineFinalReport_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Assumption Findings: Residuals vs.&nbsp;Fitted: Some heterogeneity Q-Q plot: Deviation from normality at tails (expected) Scale-Location: Heteroscedasticity Residuals vs Leverage: Some influencing points</p>
<p>Though the assumptions aren’t perfect, ANOVA is pretty durable when it comes to large sample sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Nitrogen_Treatment                  1      9     8.9   1.576   0.209    
CO2_Treatment                       1    342   341.6  60.310 9.6e-15 ***
Nitrogen_Treatment:CO2_Treatment    1      0     0.5   0.087   0.768    
Residuals                        5491  31105     5.7                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Interpretation of Output:</p>
<p>CO2 Treatment: Significant (f= 60.310, p &lt; 0.0001) Nitrogen Treatment: Not significant (f= 1.58, p = 0.209) Interaction: Not significant (f= 0.087, p = 0.768)</p>
<p>Post-hoc Time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = transpiration_rate ~ Nitrogen_Treatment * CO2_Treatment, data = data)

$Nitrogen_Treatment
                    diff        lwr        upr     p adj
Nenrich-Namb -0.08063073 -0.2065493 0.04528786 0.2094159

$CO2_Treatment
                   diff        lwr        upr p adj
Cenrich-Camb -0.5020875 -0.6288334 -0.3753416     0

$`Nitrogen_Treatment:CO2_Treatment`
                                    diff        lwr        upr     p adj
Nenrich:Camb-Namb:Camb       -0.06097305 -0.2819413  0.1599952 0.8935308
Namb:Cenrich-Namb:Camb       -0.48342492 -0.7159166 -0.2509332 0.0000006
Nenrich:Cenrich-Namb:Camb    -0.58257310 -0.8172388 -0.3479074 0.0000000
Namb:Cenrich-Nenrich:Camb    -0.42245187 -0.6578358 -0.1870680 0.0000242
Nenrich:Cenrich-Nenrich:Camb -0.52160004 -0.7591315 -0.2840686 0.0000001
Nenrich:Cenrich-Namb:Cenrich -0.09914818 -0.3474355  0.1491391 0.7340786</code></pre>
</div>
</div>
<p>Results: CO2 treatment does differentiate significantly (p &lt; 0.0001), with enriched CO2 treatment decreasing transpiration</p>
<p>Nitrogen treatment does no differ significantly</p>
<p>No signs of significant interactions between treatments</p>
<p>Interpretation: We reject the null hypothesis for CO2 treatment, showing that enriched CO2 significantly reduces transpiration. We fail to reject the null hypothesis for nitrogen treatment and the interaction of the two. Thus showing no significant effect of nitrogen or its combo with CO2 on transpiration rates.</p>
<p>Biological Interpretation: The results does side with the theory that increased CO2 leads to stomatal closure, reducing water losses(Leakey et al.&nbsp;2009). Nitrogen treatment by itself does not alter this outcome significantly, and there is no interaction, which suggests that CO2 effect on transpiration is similar not dependent on nitrogen presence (Had a little laugh that the individuals name is Leakey as their study proves that its less leakey with higher CO2)</p>
<p>Final Plot, means, and standard deviations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Nitrogen_Treatment, CO2_Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_trans =</span> <span class="fu">mean</span>(transpiration_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_trans =</span> <span class="fu">sd</span>(transpiration_rate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_trans =</span> sd_trans <span class="sc">/</span> <span class="fu">sqrt</span>(n) <span class="co">#for error bars in plot</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Nitrogen_Treatment'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>summary_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
# Groups:   Nitrogen_Treatment [2]
  Nitrogen_Treatment CO2_Treatment mean_trans sd_trans     n se_trans
  &lt;fct&gt;              &lt;fct&gt;              &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;
1 Namb               Camb                3.43     2.36  1576   0.0596
2 Namb               Cenrich             2.94     2.29  1234   0.0653
3 Nenrich            Camb                3.36     2.62  1491   0.0679
4 Nenrich            Cenrich             2.84     2.16  1194   0.0625</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x=</span> Nitrogen_Treatment, <span class="at">y =</span> mean_trans, <span class="at">color =</span> CO2_Treatment, <span class="at">group =</span> CO2_Treatment)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position=</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position=</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_trans <span class="sc">-</span> se_trans, <span class="at">ymax =</span> mean_trans<span class="sc">+</span> se_trans),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect of CO2 and Nitrogen on Transpiration Rates"</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Nitrogen Treatment"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Mean Transpiration Rate ± SE"</span>) <span class="sc">+</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AugustineFinalReport_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Challenges: During this project my main challenge was learning how to deal with all the violations of assumptions for the parametric tests. I had to teach myself (wasn’t that bad) how to use non parametric alternatives and how to interpret their results was a new skill that was not fully covered in lectures that I appreciated. Also getting really creative with my ggplot to make models, learning how to layer different things to make a plot show what I want it to show(without hiding things).</p>
<p>References: Ainsworth, E.A. &amp; Long, S.P. (2005). A meta‐analytic review of the responses of photosynthesis, canopy properties and plant production to rising CO2. New Phytologist, 165(2), 351–372.</p>
<p>Leakey, A.D.B., et al.&nbsp;(2009). Elevated CO2 effects on plant carbon, nitrogen, and water relations: Six important lessons from FACE. Journal of Experimental Botany, 60(10), 2859–2876.</p>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>